import numpy as np
from fxpmath import Fxp

SNR_QPSK = np.arange(-15, 10.1, 0.5)
Cep_QPSK = np.array([4.93691931828765e-09, 1.25729997883727e-05, 4.95668887085574e-05, 2.52124934631604e-05, 0.000234348013674605, 0.000709141946113510, 0.00157024427312953, 0.00373916205166059, 0.00765579172543018, 0.0146985939554807, 0.0252294069808368, 0.0413503747638338, 0.0620850563236995, 0.0914500155667217, 0.130846045594903, 0.178642136243666, 0.236125400812203, 0.305362799660356, 0.380650227459528, 0.463720802549823, 0.552925532499686, 0.644142711058019, 0.726697342142385, 0.804759521147269, 0.858116447101691, 0.899676960943653, 0.919821137794717, 0.917387371087115, 0.898303040658841, 0.863953949614114, 0.816186942952295, 0.762002037358427, 0.707129074788564, 0.647403675567003, 0.589101474158667, 0.534511109374663, 0.482199508407687, 0.434148333833729, 0.389684954497150, 0.349085074359618, 0.312582268245268, 0.279629462392880, 0.249641563248450, 0.222757977832616, 0.198787008825542, 0.177388364052140, 0.158217499044074, 0.141027448293010, 0.125748640577558, 0.112089855583931, 0.0999491700578633])
table_B3_QPSK = np.array([89.4427190999916, 79.7159073071006, 71.0468771716361, 63.3205959306937, 56.4345405264186, 50.2973371873174, 44.8275489538260, 39.9525950593338, 35.6077878275089, 31.7354743061347, 28.2842712474619, 25.2083832837297, 22.4669952504592, 20.0237305940181, 17.8461686768561, 15.9054145753410, 14.1757156616788, 12.6341198821885, 11.2601711974947, 10.0356381433137, 8.94427190999916, 7.97159073071006, 7.10468771716361, 6.33205959306937, 5.64345405264186, 5.02973371873174, 4.48275489538260, 3.99525950593338, 3.56077878275089, 3.17354743061347, 2.82842712474619, 2.52083832837298, 2.24669952504592, 2.00237305940181, 1.78461686768560, 1.59054145753410, 1.41757156616788, 1.26341198821885, 1.12601711974947, 1.00356381433137, 0.894427190999916, 0.797159073071006, 0.710468771716361, 0.633205959306937, 0.564345405264186, 0.502973371873174, 0.448275489538260, 0.399525950593338, 0.356077878275089, 0.317354743061347, 0.282842712474619])

SNR_8PSK = np.arange(-18, 10.1, 0.5)
Cep_8PSK = np.array([0.000492630218546025, 0.00128687891048222, 0.00279777226445706, 0.00620487612113151, 0.0116580398675536, 0.0205032794291287, 0.0340569604683263, 0.0536508519538848, 0.0817972570246614, 0.115088229058010, 0.161493813038363, 0.216924993761213, 0.282084249032598, 0.354501317722048, 0.437587236036615, 0.524454081931303, 0.617042253410908, 0.708096320604499, 0.793242788165656, 0.875438046417397, 0.950420565212706, 1.01124023528404, 1.07259794540074, 1.11623795673206, 1.16192583825258, 1.19432467367207, 1.22210312765167, 1.23907263767345, 1.24396583126882, 1.23575051505319, 1.21728414025806, 1.18568755824362, 1.13869619240288, 1.08017703015439, 1.01816980920775, 0.948986730529544, 0.876285177724824, 0.804710071277376, 0.734344177225702, 0.666112924436276, 0.601875681634811, 0.543236439611909, 0.488054224773523, 0.438197461791176, 0.392137542021537, 0.350528834247220, 0.313419485026513, 0.280160640579761, 0.250136254297616, 0.223061801578255, 0.198981348694283, 0.177499233556552, 0.158284202037496, 0.141084586001400, 0.125773442606060, 0.112122301637581, 0.0999640469485113])
table_B3_8PSK = np.array([63.0957344480193, 56.2341325190349, 50.1187233627272, 44.6683592150963, 39.8107170553497, 35.4813389233576, 31.6227766016838, 28.1838293126445, 25.1188643150958, 22.3872113856834, 19.9526231496888, 17.7827941003892, 15.8489319246111, 14.1253754462275, 12.5892541179417, 11.2201845430196, 10, 8.91250938133745, 7.94328234724282, 7.07945784384138, 6.30957344480193, 5.62341325190349, 5.01187233627272, 4.46683592150963, 3.98107170553497, 3.54813389233575, 3.16227766016838, 2.81838293126445, 2.51188643150958, 2.23872113856834, 1.99526231496888, 1.77827941003892, 1.58489319246111, 1.41253754462275, 1.25892541179417, 1.12201845430196, 1, 0.891250938133746, 0.794328234724282, 0.707945784384138, 0.630957344480193, 0.562341325190349, 0.501187233627272, 0.446683592150963, 0.398107170553497, 0.354813389233575, 0.316227766016838, 0.281838293126445, 0.251188643150958, 0.223872113856834, 0.199526231496888, 0.177827941003892, 0.158489319246111, 0.141253754462275, 0.125892541179417, 0.112201845430196, 0.100000000000000])

# SNR_QPSK = np.arange(-15, 0.1, 0.5) # 31 elements from -15dB to 0dB
# Cep_QPSK = np.array([0.0340569604683263, 0.0536508519538848, 0.0817972570246614, 0.115088229058010, 0.161493813038363, 0.216924993761213, 0.282084249032598, 0.354501317722048, 0.437587236036615, 0.524454081931303, 0.617042253410908, 0.708096320604499, 0.793242788165656, 0.875438046417397, 0.950420565212706, 1.01124023528404, 1.07259794540074, 1.11623795673206, 1.16192583825258, 1.19432467367207, 1.22210312765167, 1.23907263767345, 1.24396583126882, 1.23575051505319, 1.21728414025806, 1.18568755824362, 1.13869619240288, 1.08017703015439, 1.01816980920775, 0.948986730529544, 0.876285177724824])
# table_B3_QPSK = np.array([89.4427190999916, 79.7159073071006, 71.0468771716361, 63.3205959306937, 56.4345405264186, 50.2973371873174, 44.8275489538260, 39.9525950593338, 35.6077878275089, 31.7354743061347, 28.2842712474619, 25.2083832837297, 22.4669952504592, 20.0237305940181, 17.8461686768561, 15.9054145753410, 14.1757156616788, 12.6341198821885, 11.2601711974947, 10.0356381433137, 8.94427190999916, 7.97159073071006, 7.10468771716361, 6.33205959306937, 5.64345405264186, 5.02973371873174, 4.48275489538260, 3.99525950593338, 3.56077878275089, 3.17354743061347, 2.82842712474619])
Cep_QPSK_fp = Fxp(Cep_QPSK, signed=False, n_word=8, n_frac=7)
# table_B3_QPSK_fp = Fxp(table_B3_QPSK, signed=False, n_word=8, n_frac=3)
table_B3_QPSK_fp = Fxp(table_B3_QPSK, signed=False, n_word=8, n_frac=6)

# SNR_8PSK = SNR_QPSK
# Cep_8PSK = Cep_QPSK
# table_B3_8PSK = np.array([31.6227766016838, 28.1838293126445, 25.1188643150958, 22.3872113856834, 19.9526231496888, 17.7827941003892, 15.8489319246111, 14.1253754462275, 12.5892541179417, 11.2201845430196, 10, 8.91250938133745, 7.94328234724282, 7.07945784384138, 6.30957344480193, 5.62341325190349, 5.01187233627272, 4.46683592150963, 3.98107170553497, 3.54813389233575, 3.16227766016838, 2.81838293126445, 2.51188643150958, 2.23872113856834, 1.99526231496888, 1.77827941003892, 1.58489319246111, 1.41253754462275, 1.25892541179417, 1.12201845430196, 1])
Cep_8PSK_fp = Fxp(Cep_8PSK, signed=False, n_word=8, n_frac=7)
# table_B3_8PSK_fp = Fxp(table_B3_8PSK, signed=False, n_word=8, n_frac=4)
table_B3_8PSK_fp = Fxp(table_B3_8PSK, signed=False, n_word=8, n_frac=6)

# SNR_16QAM = SNR_QPSK
# Cep_16QAM = Cep_QPSK
SNR_16QAM = np.arange(-20, 10.1, 0.5)
Cep_16QAM=np.array([0.000375471938118254,0.00105869242934627,0.00261485008116678,0.00542697428256364,0.0110791399135397,0.0209306353708528,0.0361528794658489,0.0621893392667477,0.0958444976499434,0.144330624061374,0.206857652917616,0.290566281832377,0.401958911096794,0.534839976255548,0.702997420418629,0.905854070549811,1.14315726545357,1.41634412470576,1.71579549016983,2.00799425113281,2.26925730329257,2.51896410414729,2.66327974474087,2.74679193524791,2.74983228562786,2.70969661804803,2.62831597820378,2.51783454322628,2.39631529255017,2.26742785844192,2.13593372947430,2.00373707095285,1.86888318506904,1.73657170369972,1.60968899394447,1.48308742894794,1.36418622101880,1.24550098318595,1.13722519060421,1.03328486471442,0.935727276381503,0.845205377952531,0.762409018586949,0.685440762860701,0.614768030146808,0.551775189977161,0.493848720120956,0.441617488668509,0.394676984827061,0.352389821798283,0.314610545058716,0.280888217337803,0.250522653607435,0.223384378061349,0.199169084957630,0.177651557450173,0.158377054831235,0.141144177952428,0.125817156740586,0.112149376284120,0.0999780816036605])
# table_B3_16QAM = np.array([40.0, 35.650037525349816, 31.773129388971252, 28.317831375365525, 25.238293779207734, 22.49365300761396, 20.04748934509089, 17.867343686038524, 15.924286822139893, 14.192535569343018, 12.649110640673516, 11.273531725057815, 10.04754572603832, 8.954884554273358, 7.981049259875519, 7.113117640155691, 6.3395727698444535, 5.6501501784910175, 5.035701647176669, 4.488073817207854, 4.0, 3.5650037525349823, 3.1773129388971264, 2.8317831375365516, 2.5238293779207734, 2.2493653007613963, 2.004748934509089, 1.7867343686038526, 1.592428682213989, 1.4192535569343019, 1.2649110640673518])
table_B3_16QAM = np.array([126.49110641, 112.73531725, 100.47545726,  89.54884554,
        79.8104926 ,  71.1311764 ,  63.3957277 ,  56.50150178,
        50.35701647,  44.88073817,  40.        ,  35.65003753,
        31.77312939,  28.31783138,  25.23829378,  22.49365301,
        20.04748935,  17.86734369,  15.92428682,  14.19253557,
        12.64911064,  11.27353173,  10.04754573,   8.95488455,
         7.98104926,   7.11311764,   6.33957277,   5.65015018,
         5.03570165,   4.48807382,   4.        ,   3.56500375,
         3.17731294,   2.83178314,   2.52382938,   2.2493653 ,
         2.00474893,   1.78673437,   1.59242868,   1.41925356,
         1.26491106,   1.12735317,   1.00475457,   0.89548846,
         0.79810493,   0.71131176,   0.63395728,   0.56501502,
         0.50357016,   0.44880738,   0.4       ,   0.35650038,
         0.31773129,   0.28317831,   0.25238294,   0.22493653,
         0.20047489,   0.17867344,   0.15924287,   0.14192536,
         0.12649111])
Cep_16QAM_fp = Fxp(Cep_16QAM, signed=False, n_word=8, n_frac=7)
# Cep_16QAM_fp = Fxp(Cep_16QAM, signed=False, n_word=32, n_frac=16)
# table_B3_16QAM_fp = Fxp(table_B3_16QAM, signed=False, n_word=8, n_frac=4)
table_B3_16QAM_fp = Fxp(table_B3_16QAM, signed=False, n_word=8, n_frac=5)

SNR_BPSK = SNR_QPSK
Cep_BPSK = Cep_QPSK
table_B3_BPSK = np.array([126.49110641, 112.73531725, 100.47545726,  89.54884554,
        79.8104926 ,  71.1311764 ,  63.3957277 ,  56.50150178,
        50.35701647,  44.88073817,  40.        ,  35.65003753,
        31.77312939,  28.31783138,  25.23829378,  22.49365301,
        20.04748935,  17.86734369,  15.92428682,  14.19253557,
        12.64911064,  11.27353173,  10.04754573,   8.95488455,
         7.98104926,   7.11311764,   6.33957277,   5.65015018,
         5.03570165,   4.48807382,   4.        ,   3.56500375,
         3.17731294,   2.83178314,   2.52382938,   2.2493653 ,
         2.00474893,   1.78673437,   1.59242868,   1.41925356,
         1.26491106,   1.12735317,   1.00475457,   0.89548846,
         0.79810493,   0.71131176,   0.63395728,   0.56501502,
         0.50357016,   0.44880738,   0.4       ])
Cep_BPSK_fp = Cep_QPSK_fp
nfrac = 6 # 4/ 5 / 6 / 7 nos testes
table_B3_BPSK_fp = Fxp(table_B3_BPSK, signed=False, n_word=8, n_frac=nfrac)